<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_40) on Tue Mar 17 17:43:30 CET 2015 -->
<title>com</title>
<meta name="date" content="2015-03-17">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="com";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Package</li>
<li><a href="../com/anotherservice/db/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?com/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;com</h1>
<div class="docSummary">
<div class="block">-- START HERE -- : Explanation of the REST service principles and implementation scheme.</div>
</div>
<p>See:&nbsp;<a href="#package_description">Description</a></p>
</div>
<div class="contentContainer"><a name="package_description">
<!--   -->
</a>
<h2 title="Package com Description">Package com Description</h2>
<div class="block">-- START HERE -- : Explanation of the REST service principles and implementation scheme.
 
 <h1 style="border-bottom: 1px solid #99BBCC; color: #668899">Goal</h1>
 <p>The main goal of this REST service is to provide an easy, intuitive and flexible way of 
 offering a set of functionalities to the end-user without becoming uderly complex. 
 Hence, some bricks of the current framework are voluntarily simplified or hardcoded 
 in line with the <em>CoC</em> design pattern (convention over configuration)(aka: prefer
 using well-known simpified code rather than fully customizable complex stuff).</p>

 <h1 style="border-bottom: 1px solid #99BBCC; color: #668899">Protocol</h1>
 <h2 style="margin-left: 30px; color: #668899">REST</h2>
 <p>A REST web api is basically a resource you can call via HTTP, eventually passing in
 some parameters, and then get a response. However, there is no strict definition or
 enforcement apart from some <em>W3C</em> a posteriori attempts.</p>

 <h2 style="margin-left: 30px; color: #668899">HTTP verb</h2>
 <p>In this implementation, we deviate from the "commonly accepted" REST paradigm in that
 <strong>we do not care about the HTTP verb</strong> that is used. Why is that ?! Because
 in the concept, REST is using HTTP because it is easy and most platforms, programming 
 languages, browsers can talk HTTP, so it makes it very convenient to use. In theory,
 the HTTP protocol comes with some <em>verbs</em> (<code>GET, POST, PUT, DELETE,...</code>)
 however, in practice, only <code>GET</code> and <code>POST</code> are really used. The 
 <code>GET</code> verb is used when you type in a URL in your browser, what follows the question mark
 (<em>http://example.com/<strong>?x=y</strong></em>) are the parameters passed to the server. On
 the other hand, the <code>POST</code> verb is used when you submit a form in your browser and the
 parameters are the form data.<br />
 Of course, some random other stuff use HTTP with wierd verbs, but this is absolutely not representative
 in terms of ratio compared to <code>GET</code> and <code>POST</code>.<br />
 Hence, what is truly very easy, is that anyone can test, try and send requests using his browser
 and thus using the <code>GET</code> verb. There is currently no easy way of sending anything else than
 <code>GET</code> when typing in the URL you want to access. So we decided that we would not consider the
 HTTP verb for our REST web api ! Moreover, we allow any to be used or even combined : you can send in a 
 <code>POST</code> request with form data along URL parameters (<code>GET</code>) that will all be combined transparently
 (see combination rules below).</p>

 <h2 style="margin-left: 30px; color: #668899">URL based</h2>
 <p>Even though REST does not enforce anything about the URLs and the way to use them, we try to make everything
 as clear and intuitive as possible. For instance, some REST web apis have only one valid URL which is the root ("/")
 and everything else is passed as parameter. (I.e.: </em>/?action=addCustomer&companyName=MyCompany&...</em>)<br />
 On our side, we decided to enable the user to <em>guess</em> the URL as it is so easy to understand. For instance, if
 you want to add a new customer of your company, you may type in something like <code>/MyCompany/add/customer/John</code>.
 <br />Of course, this depends on what you, programmer, will implement using this framework ;-)<br />
 Moreover, the framework offers the possibility to use aliases in order to designate the same resource. This is simply, once
 again, an ease for the end user : why <code>/customer/list</code> would not be valid when <code>/clients/show</code> would...
 So we say that <code>customer = clients</code> and that <code>list = show</code> and thus, this is exactly the same 
 functionality behind the scenes.
 <br /><br />
 As a recap, considering the previous point explaining that we do not use the HTTP verb, we consider that the URL should be
 self-descriptive on what it does. Hence, <code>/user/delete</code> indeed deletes a user... There is no need
 to build complex requests using untestable HTTP verbs as seen in many other REST api implementations.</p>

 <h2 style="margin-left: 30px; color: #668899">Stateless</h2>
 <p>One important yet sometimes annoying fact about REST is that it is <em>supposed to be</em> stateless. This means : no session.
 Hence, this implies that successive calls to the web api cannot share info about the previous call. Each resource should be
 fully standalone. Remember that this is an API, not a GUI : this means that you may build complex multi-step interfaces and then
 execute one single request to the API behind the scenes.
 <br />With respect to security, the fact that REST is stateless means that either we do not care about authentication, or that
 valid credentials should be passed along every request. (no no, do not fall into generating a session ID that the user must 
 pass : that is not stateless! (even though in practice, you have the possibility to do so...))</p>

 <h2 style="margin-left: 30px; color: #668899">Self descriptive</h2>
 The api is built in such a way that it is rather easy for the designer to document the functionalities, the parameters and so on.
 There is an anto-generated help page that exposes this information such that any user may browse and understand how to use your methods.

 <h1 style="border-bottom: 1px solid #99BBCC; color: #668899">Workflow</h1>
 <h2 style="margin-left: 30px; color: #668899">Initialization</h2>
 <ol>
                <li>When the very first request comes in, the java application engine (i.e.: Tomcat)
                        initializes the servlet. This means that for the first request, all <em>asynchronous</em> 
                        initialization may not be complete! Anyhow, the <a href="../com/anotherservice/rest/core/Servlet.html#init()"><code>Servlet.init()</code></a> is called
                        according to the <code>web.xml</code> file in the <code>servlet-class</code> tag.</li>
                <li>The servlet registers all other <code>init-param</code> of the <code>web.xml</code> using the <a href="../com/anotherservice/util/Config.html" title="class in com.anotherservice.util"><code>Config</code></a> class.
                        Those variables are registered under the name <code>com.anotherservice.rest.core.*</code>. Thus, if you want some of those to be available
                        you may set them here. However, consider using your own config file as explained below.</li>
                <li>The <a href="../com/anotherservice/util/Logger.html" title="class in com.anotherservice.util"><code>Logger</code></a> is then initialized.</li>
                <li>The <a href="../com/anotherservice/rest/core/ServiceMonitor.html" title="class in com.anotherservice.rest.core"><code>ServiceMonitor</code></a> is started to load your custom functionalities.</li>
                <ol>
                        <li>It browses for all folders in the <em>services</em> directory (set in <code>web.xml</code>) and in a separate context each time
                                , it loads all the jar files present such that there is no conflict with other classes in other folders.</li>
                        <li>It looks for the default config file (set in <code>web.xml</code>) and looks for the <em>initializer</em> section inside it.</li>
                        <li><strong>Asynchronousely</strong> (in a separate Thread), it creates a new instance of your <a href="../com/anotherservice/rest/Initializer.html" title="interface in com.anotherservice.rest"><code>Initializer</code></a>.</li>
                        <li>You can access your own config file using <a href="../com/anotherservice/util/JarLoader.html#getResourceAsStream(java.lang.String)"><code>JarLoader.getResourceAsStream(String)</code></a> that will find it for you.</li>
                        <li>You are then supposed to register some <a href="../com/anotherservice/rest/Action.html" title="class in com.anotherservice.rest"><code>Action</code></a> or <a href="../com/anotherservice/rest/Index.html" title="class in com.anotherservice.rest"><code>Index</code></a> using 
                                <a href="../com/anotherservice/rest/Handler.html#addHandler(java.lang.String, com.anotherservice.rest.Handler)"><code>Handler.addHandler(String, Handler)</code></a>.</li>
                </ol>
 </ol>

 <h2 style="margin-left: 30px; color: #668899">Requests</h2>
 <ol>
                <li>First of all, every request is served in a new thread. This means that at all times, you should be very careful about variables and resources you use.
                        Even more when knowing that all your handlers will run in a single class instance.</li>
                <li>When a request comes in, independently of the HTTP verb, the incomming parameters are normalized in the <a href="../com/anotherservice/rest/core/Request.html" title="class in com.anotherservice.rest.core"><code>Request</code></a>.
                        If <code>GET</code> and <code>POST</code> parameters have the same name, they are merged using a semicolon. Also, the URL is split into <em>action</em> parts.</li>
                <li>The <a href="../com/anotherservice/rest/core/Router.html#route()"><code>Router.route()</code></a> is then called in order to call the apropriate registered handler.</li>
                <li>We switch back to the context of your handler, with your classes, your config and such, and we check the security with 
                        <a href="../com/anotherservice/rest/security/ISecurity.html#hasGrants(java.util.Collection)"><code>ISecurity.hasGrants(Collection)</code></a> using <a href="../com/anotherservice/rest/Handler.html#getGrants()"><code>Handler.getGrants()</code></a>.
                        Be sure you have defined some sort of <a href="../com/anotherservice/rest/security/Security.html#setInstance(com.anotherservice.rest.security.ISecurity)"><code>Security.setInstance(ISecurity)</code></a> otherwise, this will raise an exception.
                        Remember that security is essential, anywhere, anytime ;-)</li>
                <li>Your method <a href="../com/anotherservice/rest/Handler.html#execute()"><code>Handler.execute()</code></a> is called...</li>
                <ol>
                        <li>You can get the request parameters using <a href="../com/anotherservice/rest/Parameter.html#getValue()"><code>Parameter.getValue()</code></a></li>
                        <li>Those are then checked using all sort of criteria, multiple values, optional, min/max length and so on...</li>
                        <li>You may insert some stuff in the <a href="../com/anotherservice/db/Database.html" title="class in com.anotherservice.db"><code>Database</code></a> safely using <a href="../com/anotherservice/rest/security/Security.html#escape(java.lang.String)"><code>Security.escape(String)</code></a>.</li>
                        <li>You should return the result of your job. Base types are okay, more complex objects should be returned with care.</li>
                </ol>
                <li>Finally, the <a href="../com/anotherservice/rest/core/Responder.html" title="class in com.anotherservice.rest.core"><code>Responder</code></a> will send your return value in the proper format.</li>
 </ol>

 <h2 style="margin-left: 30px; color: #668899">Examples</h2>
 Now that you have a better view on the workflow, you can just give it a try using the examples provided in the <a href="../com/anotherservice/rest/package-summary.html"><code>com.anotherservice.rest</code></a> package documentation.</div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Package</li>
<li><a href="../com/anotherservice/db/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?com/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
